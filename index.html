<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dedicatoria para Orielys ‚Äî Carta 3D</title>
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Quicksand:wght@300;500;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg1:hsl(330, 100%, 99%);
      --bg2:#f8c9d7;
      --accent:#ff4f7d;
      --muted:#6b6b6b;
      --shadow:0 10px 30px rgba(17,17,17,0.08);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;overflow:hidden}
    body{
      font-family:'Quicksand',system-ui,Segoe UI,Roboto,Helvetica Neue,Arial;
      background:linear-gradient(180deg,var(--bg1),var(--bg2));
      display:flex;align-items:center;justify-content:center;
      padding:20px;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    .scene{width:100%;max-width:980px;perspective:1200px;position:relative}
    .card-wrap{
      width:min(92vw,740px);
      height:min(62vw,470px);
      min-height:360px;
      margin:0 auto;
      position:relative;
      transform-style:preserve-3d;
      transition:transform .3s ease;
      cursor:grab;
    }
    .envelope{
      width:100%;height:100%;position:relative;
      transform-style:preserve-3d;
      transition:transform 1s cubic-bezier(.2,.9,.25,1);
      transform-origin:top center;
      box-shadow:var(--shadow);
      border-radius:16px;
      overflow:visible;
    }
    .body{position:absolute;inset:0;background:linear-gradient(180deg,#fff,#fff9);border-radius:14px;padding:40px 40px 60px;display:flex;flex-direction:column;justify-content:flex-end;align-items:flex-start;transform:translateZ(-0.5px)}
    .to{font-family:'Great Vibes',cursive;font-size:38px;color:var(--accent);margin:0 0 8px}
    .subtitle{color:var(--muted);font-size:15px;margin:0 0 14px;font-weight:500}
    .flap{position:absolute;left:0;right:0;top:0;height:58%;border-top-left-radius:16px;border-top-right-radius:16px;background:linear-gradient(180deg,#ffeff3,#fff);transform-origin:top center;z-index:3;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:transform 0.9s cubic-bezier(.2,.9,.25,1);box-shadow:0 8px 20px rgba(0,0,0,0.06)}
    .seal{width:100px;height:100px;border-radius:50%;background:linear-gradient(180deg,var(--accent),#ff2f65);display:flex;align-items:center;justify-content:center;color:white;font-size:30px;box-shadow:0 8px 18px rgba(255,107,139,0.24);transform:translateZ(35px);transition:transform 0.18s ease}
    .seal:active{transform:translateZ(30px) scale(0.97)}
    .inner{position:absolute;left:11%;right:11%;top:16%;bottom:10%;background:linear-gradient(180deg,#fff,#fffefc);border-radius:12px;padding:28px;font-family:'Quicksand',sans-serif;font-size:18px;color:#222;transform-origin:top center;transform:translateZ(-40px) rotateX(0deg);box-shadow:0 8px 24px rgba(0,0,0,0.06);transition:transform 1s cubic-bezier(.2,.9,.25,1),opacity 0.6s;overflow-y:auto}
    .closed .flap{transform:rotateX(0deg)}
    .closed .inner{opacity:0;transform:translateY(8px) translateZ(-40px) rotateX(14deg)}
    .open .flap{transform:rotateX(-160deg)}
    .open .inner{opacity:1;transform:translateY(0) translateZ(0) rotateX(0deg)}
    .hearts-rain{position:absolute;inset:0;pointer-events:none;overflow:hidden}
    .heart{position:absolute;left:50%;width:28px;height:28px;transform:translateX(-50%);opacity:0;filter:blur(3px);animation:fall 3s linear forwards}
    .heart svg{width:100%;height:100%}
    @keyframes fall{0%{transform:translateY(-20vh) translateX(0) scale(0.7);opacity:0}10%{opacity:0.9}100%{transform:translateY(120vh) translateX(40px) scale(1.05);opacity:0}}
    .bg-dots{position:absolute;inset:-20%;background-image:radial-gradient(rgba(255,107,139,0.06) 1px,transparent 1px);background-size:24px 24px;opacity:0.9;pointer-events:none}
    .letter-title{font-family:'Great Vibes',cursive;font-size:36px;color:var(--accent);margin:0 0 14px;text-align:center}
    .letter-body{font-size:18px;line-height:1.72;color:#333;margin-top:6px;text-align:justify}
    .letter-body p + p{margin-top:14px}
    .close-note{margin-top:20px;text-align:right;font-weight:700;color:var(--accent)}
    .toggle-btn{position:absolute;bottom:14px;right:14px;background:var(--accent);color:white;border:0;border-radius:8px;padding:8px 14px;font-weight:600;cursor:pointer;box-shadow:0 4px 10px rgba(0,0,0,0.12);display:none}
    .open .toggle-btn{display:block}

    @media (max-width:780px){
      .card-wrap{height:min(130vw,520px);min-height:380px}
      .inner{left:6%;right:6%;top:20%;bottom:11%;padding:20px}
      .seal{width:78px;height:78px;font-size:26px}
      .to{font-size:30px}
      .letter-title{font-size:30px}
      .letter-body{font-size:16px}
    }
  </style>
</head>
<body>
  <div class="scene">
    <div class="card-wrap" id="wrap">
      <div class="envelope closed" id="envelope">
        <div class="flap" id="flap" role="button" aria-label="Abrir carta" tabindex="0">
          <div class="seal" id="seal">‚ù§</div>
        </div>

        <div class="body">
          <div>
            <h3 class="to">Para: <strong>Orielys</strong></h3>
            <p class="subtitle">Mi lugar favorito siempre ser√° donde est√©s t√∫.</p>
          </div>
        </div>

        <div class="inner" id="inner">
          <h2 class="letter-title">Para ti, mi amor <3 </h2>
          <div class="letter-body">
            <p>
              Gracias por iluminar mi vida con tu forma tan hermosa de ser. Desde que llegaste,
              todo tiene m√°s color, m√°s calma y m√°s sentido. Eres esa persona que transforma
              un d√≠a normal en un recuerdo bonito.
            </p>
            <p>
              Amo c√≥mo me haces sonre√≠r, c√≥mo me escuchas, c√≥mo me entiendes y c√≥mo me acompa√±as
              incluso en los momentos simples. Contigo he aprendido que amar tambi√©n es cuidar,
              respetar, apoyar y elegirte cada d√≠a con el coraz√≥n.
            </p>
            <p>
              Quiero seguir construyendo momentos a tu lado: m√°s conversaciones largas,
              m√°s abrazos que curan, m√°s planes improvisados, m√°s risas y m√°s sue√±os compartidos.
              Eres mi presente favorito y una de mis razones para creer en un futuro hermoso.
            </p>
            <p>
              Hoy solo quiero recordarte algo muy simple, pero muy verdadero:
              te amo profundamente, Orielys, y me siento afortunado de tenerte. Feliz san valentin. üíó
            </p>
            <p class="close-note">Con todo mi amor,<br>David ‚ù§Ô∏è</p>
          </div>
        </div>

        <div class="hearts-rain" id="hearts"></div>
        <div class="bg-dots" aria-hidden="true"></div>
      </div>

      <button class="toggle-btn" id="toggleBtn" type="button">Cerrar carta</button>
    </div>
  </div>

  <script>
    const envelope = document.getElementById('envelope');
    const flap = document.getElementById('flap');
    const seal = document.getElementById('seal');
    const hearts = document.getElementById('hearts');
    const toggleBtn = document.getElementById('toggleBtn');
    const wrap = document.getElementById('wrap');
    let opened = false;

    function spawnHeart() {
      const heart = document.createElement('div');
      heart.className = 'heart';
      heart.style.left = `${Math.random() * 100}%`;
      heart.style.top = '-10%';
      heart.style.animationDuration = `${2.7 + Math.random() * 1.8}s`;
      heart.innerHTML = '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 21s-7.5-4.92-9.25-8.04C.84 9.9 4.1 5 8.5 6.5 10.07 7.1 11 8.5 12 9.5c1-1 1.93-2.4 3.5-3 4.4-1.5 7.66 3.4 5.75 6.96C19.5 16.08 12 21 12 21z" fill="rgba(255,90,130,0.95)"/></svg>';
      hearts.appendChild(heart);
      setTimeout(() => heart.remove(), 5200 + Math.random() * 800);
    }

    function startRain(total = 30, interval = 120) {
      let i = 0;
      const iv = setInterval(() => {
        spawnHeart();
        i += 1;
        if (i >= total) clearInterval(iv);
      }, interval);
    }

    function openLetter() {
      if (opened) return;
      opened = true;
      envelope.classList.remove('closed');
      envelope.classList.add('open');
      toggleBtn.textContent = 'Cerrar carta';
      seal.animate(
        [
          { transform: 'translateZ(35px) scale(1)' },
          { transform: 'translateZ(60px) scale(1.12)' },
          { transform: 'translateZ(35px) scale(1)' }
        ],
        { duration: 500, easing: 'cubic-bezier(.2,.9,.25,1)' }
      );
      startRain();
      setTimeout(() => startRain(20, 140), 700);
      setTimeout(() => startRain(20, 140), 1400);
    }

    function closeLetter() {
      opened = false;
      envelope.classList.remove('open');
      envelope.classList.add('closed');
      toggleBtn.textContent = 'Abrir carta';
    }

    flap.addEventListener('click', openLetter);
    toggleBtn.addEventListener('click', () => (opened ? closeLetter() : openLetter()));
    flap.addEventListener('keydown', (event) => {
      if (event.key === 'Enter' || event.key === ' ') {
        event.preventDefault();
        openLetter();
      }
    });

    let rotationX = 0;
    let rotationY = 0;
    let isDragging = false;
    let lastX = 0;
    let lastY = 0;

    function updateRotation() {
      envelope.style.transform = `rotateX(${rotationX}deg) rotateY(${rotationY}deg)`;
    }

    function startDrag(x, y) {
      isDragging = true;
      lastX = x;
      lastY = y;
      wrap.style.cursor = 'grabbing';
    }

    function moveDrag(x, y) {
      if (!isDragging) return;
      const dx = x - lastX;
      const dy = y - lastY;
      rotationY += dx * 0.3;
      rotationX -= dy * 0.3;
      rotationX = Math.max(-60, Math.min(60, rotationX));
      updateRotation();
      lastX = x;
      lastY = y;
    }

    function endDrag() {
      isDragging = false;
      wrap.style.cursor = 'grab';
    }

    wrap.addEventListener('mousedown', (event) => startDrag(event.clientX, event.clientY));
    window.addEventListener('mousemove', (event) => moveDrag(event.clientX, event.clientY));
    window.addEventListener('mouseup', endDrag);
    wrap.addEventListener('touchstart', (event) => startDrag(event.touches[0].clientX, event.touches[0].clientY));
    window.addEventListener('touchmove', (event) => moveDrag(event.touches[0].clientX, event.touches[0].clientY));
    window.addEventListener('touchend', endDrag);
  </script>
</body>
</html>
